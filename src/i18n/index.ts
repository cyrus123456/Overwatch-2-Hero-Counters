import type { ReactNode } from 'react';
import React, { createContext, useCallback, useContext, useEffect, useState } from 'react';

export type Language = 'zh' | 'en' | 'ja' | 'ko' | 'zh-TW' | 'es' | 'fr' | 'de' | 'pt' | 'ru' | 'it';

const translations: Record<Language, Record<string, string>> = {
  zh: {
    title: '守望先锋英雄被克制关系图',
    subtitle: 'Overwatch 2 Hero Counters - 谁克制我',
    allHeroes: '全部英雄',
    tank: '坦克',
    damage: '输出',
    support: '支援',
    roleFilter: '角色筛选',
    instructions: '使用说明',
    stats: '数据统计',
    totalHeroes: '英雄总数',
    counterRelations: '被克制关系',
    counteredBy: '被克制（怕这些）',
    counters: '克制（打这些）',
    deselect: '取消选择',
    grayArrow: '亮灰色箭头',
    arrowDirection: '箭头方向',

    dragNodes: '拖拽节点可调整位置',
    scrollZoom: '滚轮缩放画布',
    hoverView: '悬停查看克制/被克制关系',
    clickHighlight: '点击高亮相关连线',
    counterRelation: '被克制关系',
    whoCountersWho: 'A → B 表示 A 克制 B',
    language: '语言',
    github: 'GitHub',
    interactiveViz: '被克制关系可视化',
    loading: '加载中...',
    selectHeroPrompt: '请选择一位英雄展示克制关系',
    mapRecommendations: '地图强势英雄首发阵容推荐',
    heroCounterPanel: '英雄克制关系',
    networkNodeIntro: '网络节点介绍',
    mapType: '地图类型',
    recommendedHeroes: '推荐英雄',
    control: '占领要点',
    hybrid: '混合模式',
    escort: '运载目标',
    push: '推进模式',
    flashpoint: '闪点模式',
    lv3Desc: '绝对克制 (职业天敌)',
    lv2Desc: '明显克制 (强势压制)',
    lv1Desc: '轻微克制 (博弈优势)',
    nodeSizeTip: '节点尺寸：克制越强，节点越大',
    nodeSizeLv3: 'LV.3 强克制：节点最大',
    nodeSizeLv2: 'LV.2 中克制：节点中等',
    nodeSizeLv1: 'LV.1 弱克制：节点较小',
    tankBrief: '高血量、防御核心',
    damageBrief: '高伤害、击杀核心',
    supportBrief: '治疗、战术增益',
    clickDesc: '点击英雄：展示其专属克制网并放大图标',
    dragDesc: '拖拽图标：长按并移动英雄可手动调整位置',
    zoomDesc: '滚轮缩放：在画布滚动鼠标中键可放大缩小',
    hoverDesc: '悬停预览：移动鼠标到头像上可查看高亮并微缩无关项',
    panDesc: '移动画板：左键或中键拖拽画布任意位置可平移整个关系图',
    interactionGuide: '交互说明',
    
    hardCounter: '硬克制',
    strongCounter: '强力',
    softCounter: '轻微',
    notCounteredByAny: '暂未被任何英雄克制',
    noCounters: '暂无克制的英雄',
    counteredByTemplate: '被克制文本模板',
    countersTemplate: '克制文本模板',
    counteredByHeader: ' 被以下英雄 克制 :',
    countersHeader: ' 克制 以下英雄 :',
    copied: '已复制',
    copy: '复制',
    copyTip: '双击文本或点击按钮复制，发送攻略到队友聊天窗口帮助队友选择英雄',
    counter: '克制',
    doubleClickToCopy: '双击复制',
    strength3: '★★★强',
    strength2: '★★中',
    strength1: '★弱',
    noCounterData: '暂无足够的克制数据生成模板',
    all: '全部',
    searchMapsPlaceholder: '快速查找地图...',
    startingLineup: '首发阵容',
    copyLineupTip: '复制阵容发送到聊天框帮助队友选择英雄',
    previewContent: '预览完整复制内容',
    recommendedLineup: '推荐首发阵容',
    selectLanguage: '点击选择语言',
  },
  en: {
    title: 'Overwatch 2 Hero Counter Relationships',
    subtitle: 'Who Counters Who - Counter Graph',
    allHeroes: 'All Heroes',
    tank: 'Tank',
    damage: 'Damage',
    support: 'Support',
    roleFilter: 'Role Filter',
    instructions: 'Instructions',
    stats: 'Statistics',
    totalHeroes: 'Total Heroes',
    counterRelations: 'Counter Relations',
    counteredBy: 'Countered By (Weak Against)',
    counters: 'Counters (Strong Against)',
    deselect: 'Deselect',
    grayArrow: 'Light Gray Arrow',
    arrowDirection: 'Arrow Direction',

    dragNodes: 'Drag nodes to reposition',
    scrollZoom: 'Scroll to zoom',
    hoverView: 'Hover to view counter relationships',
    clickHighlight: 'Click to highlight connections',
    counterRelation: 'Counter Relationship',
    whoCountersWho: 'A → B means A counters B',
    language: 'Language',
    github: 'GitHub',
    interactiveViz: 'Interactive Visualization',
    loading: 'Loading...',
    selectHeroPrompt: 'Please select a hero to view counter relationships',
    mapRecommendations: 'Map First Pick Recommendations',
    heroCounterPanel: 'Hero Counter Relations',
    networkNodeIntro: 'Network Node Introduction',
    mapType: 'Map Type',
    recommendedHeroes: 'Recommended Heroes',
    control: 'Control',
    hybrid: 'Hybrid',
    escort: 'Escort',
    push: 'Push',
    flashpoint: 'Flashpoint',
    lv3Desc: 'Hard Counter (Direct Nemesis)',
    lv2Desc: 'Strong Counter (Solid Advantage)',
    lv1Desc: 'Soft Counter (Skill Matchup)',
    nodeSizeTip: 'Node Size: Stronger counter = Larger node',
    nodeSizeLv3: 'LV.3 Hard: Largest nodes',
    nodeSizeLv2: 'LV.2 Medium: Medium nodes',
    nodeSizeLv1: 'LV.1 Small: Smaller nodes',
    tankBrief: 'High Health, Frontline Tank',
    damageBrief: 'High DPS, Damage Dealer',
    supportBrief: 'Healer, Utility Support',
    clickDesc: 'Click Hero: Focus on their relations & scale icon',
    dragDesc: 'Drag Icon: Hold and move to reposition manually',
    zoomDesc: 'Scroll Zoom: Use mouse wheel to zoom in/out',
    hoverDesc: 'Hover Focus: Mouse over icon to highlight and focus',
    panDesc: 'Pan: Drag canvas with left or middle mouse button to move the graph',
    interactionGuide: 'Interaction Guide',
    hardCounter: 'Hard',
    strongCounter: 'Strong',
    softCounter: 'Soft',
    notCounteredByAny: 'Not currently countered by any hero',
    noCounters: 'No heroes countered yet',
    counteredByTemplate: 'Weak Against Template',
    countersTemplate: 'Strong Against Template',
    counteredByHeader: ' is countered by:',
    countersHeader: ' counters:',
    copied: 'Copied',
    copy: 'Copy',
    copyTip: 'Double-click or click button to copy, send to teammates to help pick heroes',
    counter: 'Counter',
    doubleClickToCopy: 'Double-click to copy',
    strength3: '★★★Hard',
    strength2: '★★Medium',
    strength1: '★Soft',
    noCounterData: 'Not enough counter data to generate template',
    all: 'All',
    searchMapsPlaceholder: 'Search maps...',
    startingLineup: 'Starting Lineup',
    copyLineupTip: 'Copy lineup to chat to help teammates',
    previewContent: 'Preview Full Content',
    recommendedLineup: 'Recommended Lineup',
    selectLanguage: 'Click to select language',
  },
  ja: {
    title: 'オーバーチュア ヒーロー相性図',
    subtitle: 'Overwatch 2 ヒーローカウンター チェッカー',
    allHeroes: '全ヒーロー',
    tank: 'タンク',
    damage: 'ダメージ',
    support: 'サポート',
    roleFilter: 'ロールフィルター',
    instructions: '使い方',
    stats: '統計',
    totalHeroes: 'ヒーロー総数',
    counterRelations: '相性関係',
    counteredBy: '不利（これらのヒーロー）',
    counters: '有利（これらのヒーロー）',
    deselect: '選択解除',
    grayArrow: 'ライトグレーアロー',
    arrowDirection: 'アロー方向',
    dragNodes: 'ノードをドラッグして位置を調整',
    scrollZoom: 'スクロールでズーム',
    hoverView: 'ホバーして相性を表示',
    clickHighlight: 'クリックでハイライト',
    counterRelation: '相性関係',
    whoCountersWho: 'A → B は A が B をカウンター',
    language: '言語',
    github: 'GitHub',
    interactiveViz: '相性関係可视化',
    loading: '読み込み中...',
    selectHeroPrompt: '相性を表示するヒーローを選択してください',
    mapRecommendations: 'マップ別おすすめピック',
    heroCounterPanel: 'ヒーロー相性関係',
    networkNodeIntro: 'ネットワークノード紹介',
    mapType: 'マップタイプ',
    recommendedHeroes: 'おすすめヒーロー',
    control: 'コントロール',
    hybrid: 'ハイブリッド',
    escort: 'エスコート',
    push: 'プッシュ',
    flashpoint: 'フラッシュポイント',
    lv3Desc: '絶対不利（天敵）',
    lv2Desc: '明確な不利（優位）',
    lv1Desc: '軽微な不利（スキル差）',
    nodeSizeTip: 'ノードサイズ：不利ほど大きい',
    nodeSizeLv3: 'LV.3 最大サイズ',
    nodeSizeLv2: 'LV.2 中サイズ',
    nodeSizeLv1: 'LV.1 小サイズ',
    tankBrief: '高体力、前衛タンク',
    damageBrief: '高火力、ダメージディーラー',
    supportBrief: 'ヒーラー、補助サポート',
    clickDesc: 'クリック：相性を表示',
    dragDesc: 'ドラッグ：位置を調整',
    zoomDesc: 'ズーム：マウスホイール',
    hoverDesc: 'ホバー：ハイライト表示',
    panDesc: 'パン：ドラッグで移動 / 中クリックでキャンバス移動',
    hardCounter: '絶対不利',
    strongCounter: '不利',
    softCounter: '軽微',
    notCounteredByAny: '現在不利なヒーローはありません',
    noCounters: '有利なヒーローはありません',
    counteredByTemplate: '不利テンプレート',
    countersTemplate: '有利テンプレート',
    counteredByHeader: ' に以下のヒーロー対策 :',
    countersHeader: ' は以下のヒーローを対策 :',
    copied: 'コピー済み',
    copy: 'コピー',
    copyTip: 'ダブルクリックまたはコピーボタンでコピー',
    counter: 'カウンター',
    doubleClickToCopy: 'ダブルクリックでコピー',
    strength3: '★★★不利',
    strength2: '★★中程度',
    strength1: '★軽微',
    noCounterData: 'テンプレート生成のデータが不十分です',
    all: 'すべて',
    searchMapsPlaceholder: 'マップを検索...',
    startingLineup: '初期ラインナップ',
    copyLineupTip: 'チャットでチームメイトにコピー',
    previewContent: 'プレビュー',
    recommendedLineup: 'おすすめラインナップ',
    selectLanguage: '言語を選択してください',
  },
  ko: {
    title: '오버워치 2 영웅 상성図',
    subtitle: 'Overwatch 2 영웅 카운터 관계',
    allHeroes: '전체 영웅',
    tank: '탱커',
    damage: '딜러',
    support: '서포터',
    roleFilter: '역할 필터',
    instructions: '사용 방법',
    stats: '통계',
    totalHeroes: '영웅 총수',
    counterRelations: '상성 관계',
    counteredBy: '불리（이 영웅들）',
    counters: '유리（이 영웅들）',
    deselect: '선택 해제',
    grayArrow: '라이트 그레이 화살표',
    arrowDirection: '화살표 방향',
    dragNodes: '노드를 드래그하여 위치 조정',
    scrollZoom: '스크롤로 줌',
    hoverView: '호버하여 상성 보기',
    clickHighlight: '클릭하여 하이라이트',
    counterRelation: '상성 관계',
    whoCountersWho: 'A → B 는 A 가 B 를 카운터',
    language: '언어',
    github: 'GitHub',
    interactiveViz: '상성 관계 시각화',
    loading: '로딩 중...',
    selectHeroPrompt: '상성을 볼 영웅을 선택하세요',
    mapRecommendations: '맵별 추천 픽',
    heroCounterPanel: '영웅 상성 관계',
    networkNodeIntro: '네트워크 노드 소개',
    mapType: '맵 유형',
    recommendedHeroes: '추천 영웅',
    control: '점령',
    hybrid: '혼합',
    escort: '호위',
    push: '진격',
    flashpoint: '플래시포인트',
    lv3Desc: '완전 불리（천적）',
    lv2Desc: '명확한 불리（우세）',
    lv1Desc: '경미한 불리（스킬 차이）',
    nodeSizeTip: '노드 크기：불리할수록 큼',
    nodeSizeLv3: 'LV.3 최대 크기',
    nodeSizeLv2: 'LV.2 중간 크기',
    nodeSizeLv1: 'LV.1 작은 크기',
    tankBrief: '고 체력, 프론트라인 탱커',
    damageBrief: '고 화력, 딜러',
    supportBrief: '힐러, 유틸 서포터',
    clickDesc: '클릭：상성 표시',
    dragDesc: '드래그：위치 조정',
    zoomDesc: '줌：마우스 휠',
    hoverDesc: '호버：하이라이트',
    panDesc: '팬：왼쪽 또는 미들 버튼으로 캔버스를 드래그하여 이동',
    interactionGuide: '조작 안내',
    hardCounter: '완전 불리',
    strongCounter: '불리',
    softCounter: '경미',
    notCounteredByAny: '현재 불리한 영웅이 없습니다',
    noCounters: '유리한 영웅이 없습니다',
    counteredByTemplate: '불리 템플릿',
    countersTemplate: '유리 템플릿',
    counteredByHeader: ' 은(는) 다음 영웅에게 불리합니다 :',
    countersHeader: ' 은(는) 다음 영웅을 억제합니다 :',
    copied: '복사됨',
    copy: '복사',
    copyTip: '더블 클릭 또는 복사 버튼으로 복사',
    counter: '카운터',
    doubleClickToCopy: '더블 클릭으로 복사',
    strength3: '★★★불리',
    strength2: '★★중간',
    strength1: '★경미',
    noCounterData: '템플릿 생성 데이터 부족',
    all: '전체',
    searchMapsPlaceholder: '맵 검색...',
    startingLineup: '초기 라인업',
    copyLineupTip: '팀원에게 복사',
    previewContent: '미리보기',
    recommendedLineup: '추천 라인업',
    selectLanguage: '언어를 선택하세요',
  },
  'zh-TW': {
    title: '鬥陣特攻英雄被剋制關係圖',
    subtitle: 'Overwatch 2 Hero Counters - 誰剋制我',
    allHeroes: '全部英雄',
    tank: '坦克',
    damage: '輸出',
    support: '支援',
    roleFilter: '角色篩選',
    instructions: '使用說明',
    stats: '數據統計',
    totalHeroes: '英雄總數',
    counterRelations: '被剋制關係',
    counteredBy: '被剋制（怕這些）',
    counters: '剋制（打這些）',
    deselect: '取消選擇',
    grayArrow: '亮灰色箭頭',
    arrowDirection: '箭頭方向',
    dragNodes: '拖拽節點可調整位置',
    scrollZoom: '滾輪縮放畫布',
    hoverView: '懸停查看剋制/被剋制關係',
    clickHighlight: '點擊高亮相關連線',
    counterRelation: '被剋制關係',
    whoCountersWho: 'A → B 表示 A 剋制 B',
    language: '語言',
    github: 'GitHub',
    interactiveViz: '被剋制關係視覺化',
    loading: '載入中...',
    selectHeroPrompt: '請選擇一位英雄展示剋制關係',
    mapRecommendations: '地圖強勢英雄首發陣容推薦',
    heroCounterPanel: '英雄剋制關係',
    networkNodeIntro: '網絡節點介紹',
    mapType: '地圖類型',
    recommendedHeroes: '推薦英雄',
    control: '佔領要點',
    hybrid: '混合模式',
    escort: '運載目標',
    push: '推進模式',
    flashpoint: '閃點模式',
    lv3Desc: '絕對剋制（職業天敵）',
    lv2Desc: '明顯剋制（強勢壓制）',
    lv1Desc: '輕微剋制（博弈優勢）',
    nodeSizeTip: '節點尺寸：剋制越強，節點越大',
    nodeSizeLv3: 'LV.3 強剋制：節點最大',
    nodeSizeLv2: 'LV.2 中剋制：節點中等',
    nodeSizeLv1: 'LV.1 弱剋制：節點較小',
    tankBrief: '高血量、防禦核心',
    damageBrief: '高傷害、擊殺核心',
    supportBrief: '治療、戰術增益',
    clickDesc: '點擊英雄：展示其專屬剋制網並放大圖示',
    dragDesc: '拖拽圖示：長按並移動英雄可手動調整位置',
    zoomDesc: '滾輪縮放：在畫布滾動滑鼠中鍵可放大縮小',
    hoverDesc: '懸停預覽：移動滑鼠到頭像上可查看高亮並微縮無關項',
    panDesc: '移動畫板：左鍵或中鍵拖拽畫布任意位置可平移整個關係圖',
    interactionGuide: '互動說明',
    hardCounter: '硬剋制',
    strongCounter: '強力',
    softCounter: '輕微',
    notCounteredByAny: '暫未被任何英雄剋制',
    noCounters: '暫無剋制的英雄',
    counteredByTemplate: '被剋制文字模板',
    countersTemplate: '剋制文字模板',
    counteredByHeader: ' 被以下英雄 剋制 :',
    countersHeader: ' 剋制 以下英雄 :',
    copied: '已複製',
    copy: '複製',
    copyTip: '雙擊文字或點擊按鈕複製，發送攻略到隊友聊天窗口幫助隊友選擇英雄',
    counter: '剋制',
    doubleClickToCopy: '雙擊複製',
    strength3: '★★★強',
    strength2: '★★中',
    strength1: '★弱',
    noCounterData: '暫無足夠的剋制數據生成模板',
    all: '全部',
    searchMapsPlaceholder: '快速查找地圖...',
    startingLineup: '首發陣容',
    copyLineupTip: '複製陣容發送到聊天框幫助隊友選擇英雄',
    previewContent: '預覽完整複製內容',
    recommendedLineup: '推薦首發陣容',
    selectLanguage: '點擊選擇語言',
  },
  es: {
    title: 'Sobrecarga de Contadores de Héroes de Overwatch 2',
    subtitle: 'Relaciones de Contra de Héroes - ¿Quién Contra a Quién?',
    allHeroes: 'Todos los Héroes',
    tank: 'Tanque',
    damage: 'Daño',
    support: 'Apoyo',
    roleFilter: 'Filtro de Rol',
    instructions: 'Instrucciones',
    stats: 'Estadísticas',
    totalHeroes: 'Total de Héroes',
    counterRelations: 'Relaciones de Contra',
    counteredBy: 'Contra (Débil Contra)',
    counters: 'Contra (Fuerte Contra)',
    deselect: 'Deseleccionar',
    grayArrow: 'Flecha Gris Clara',
    arrowDirection: 'Dirección de Flecha',
    dragNodes: 'Arrastra nodos para reposicionar',
    scrollZoom: 'Scroll para zoom',
    hoverView: 'Hover para ver relaciones',
    clickHighlight: 'Click para resaltar conexiones',
    counterRelation: 'Relación de Contra',
    whoCountersWho: 'A → B significa A contra B',
    language: 'Idioma',
    github: 'GitHub',
    interactiveViz: 'Visualización Interactiva',
    loading: 'Cargando...',
    selectHeroPrompt: 'Selecciona un héroe para ver relaciones',
    mapRecommendations: 'Recomendaciones de Mapa',
    heroCounterPanel: 'Relaciones de Contra de Héroes',
    networkNodeIntro: 'Introducción de Nodos',
    mapType: 'Tipo de Mapa',
    recommendedHeroes: 'Héroes Recomendados',
    control: 'Control',
    hybrid: 'Híbrido',
    escort: 'Escolta',
    push: 'Empuje',
    flashpoint: 'Punto Flash',
    lv3Desc: 'Contra Dura (Némesis)',
    lv2Desc: 'Contra Fuerte (Ventaja)',
    lv1Desc: 'Contra Suave (Habilidad)',
    nodeSizeTip: 'Tamaño nodo: Contra más fuerte = Nodo más grande',
    nodeSizeLv3: 'LV.3 Máximo tamaño',
    nodeSizeLv2: 'LV.2 Tamaño medio',
    nodeSizeLv1: 'LV.1 Tamaño pequeño',
    tankBrief: 'Alta Salud, Tanque',
    damageBrief: 'Alto DPS, Daño',
    supportBrief: 'Curación, Soporte',
    clickDesc: 'Click: Ver relaciones',
    dragDesc: 'Arrastrar: Mover posición',
    zoomDesc: 'Zoom: Rueda del mouse',
    hoverDesc: 'Hover: Resaltar',
    panDesc: 'Pan: Arrastrar el lienzo con clic izquierdo o central para mover',
    interactionGuide: 'Guía de Interacción',
    hardCounter: 'Contra Dura',
    strongCounter: 'Contra Fuerte',
    softCounter: 'Contra Suave',
    notCounteredByAny: 'No countered by any hero',
    noCounters: 'No heroes countered yet',
    counteredByTemplate: 'Plantilla Débil',
    countersTemplate: 'Plantilla Fuerte',
    counteredByHeader: ' es contrarrestado por:',
    countersHeader: ' contrarresta a:',
    copied: 'Copiado',
    copy: 'Copiar',
    copyTip: 'Double-click or click button to copy',
    counter: 'Contra',
    doubleClickToCopy: 'Double-click to copy',
    strength3: '★★★Dura',
    strength2: '★★Media',
    strength1: '★Suave',
    noCounterData: 'Not enough data',
    all: 'Todos',
    searchMapsPlaceholder: 'Buscar mapas...',
    startingLineup: 'Lineup Inicial',
    copyLineupTip: 'Copy lineup to chat',
    previewContent: 'Vista Previa',
    recommendedLineup: 'Lineup Recomendado',
    selectLanguage: 'Seleccionar Idioma',
  },
  fr: {
    title: 'Relations de Contre des Héros Overwatch 2',
    subtitle: 'Qui Contre Qui - Graphique de Contre',
    allHeroes: 'Tous les Héros',
    tank: 'Tank',
    damage: 'Dégâts',
    support: 'Support',
    roleFilter: 'Filtre de Rôle',
    instructions: 'Instructions',
    stats: 'Statistiques',
    totalHeroes: 'Total des Héros',
    counterRelations: 'Relations de Contre',
    counteredBy: 'Contre (Faible Contre)',
    counters: 'Contre (Fort Contre)',
    deselect: 'Désélectionner',
    grayArrow: 'Flèche Grise',
    arrowDirection: 'Direction de Flèche',
    dragNodes: 'Glisser les nœuds pour repositionner',
    scrollZoom: 'Scroll pour zoomer',
    hoverView: 'Survol pour voir les relations',
    clickHighlight: 'Cliquer pour surligner',
    counterRelation: 'Relation de Contre',
    whoCountersWho: 'A → B signifie A contre B',
    language: 'Langue',
    github: 'GitHub',
    interactiveViz: 'Visualisation Interactive',
    loading: 'Chargement...',
    selectHeroPrompt: 'Sélectionnez un héros pour voir les relations',
    mapRecommendations: 'Recommandations de Carte',
    heroCounterPanel: 'Relations de Contre',
    networkNodeIntro: 'Intro des Nœuds',
    mapType: 'Type de Carte',
    recommendedHeroes: 'Héros Recommandés',
    control: 'Contrôle',
    hybrid: 'Hybride',
    escort: 'Escorte',
    push: 'Poussée',
    flashpoint: 'Point Flash',
    lv3Desc: 'Contre Dur (Némésis)',
    lv2Desc: 'Contre Fort (Avantage)',
    lv1Desc: 'Contre Doux (Compétence)',
    nodeSizeTip: 'Taille noeud: Plus fort = Plus grand',
    nodeSizeLv3: 'LV.3 Taille maximum',
    nodeSizeLv2: 'LV.2 Taille moyenne',
    nodeSizeLv1: 'LV.1 Taille petite',
    tankBrief: 'Santé Élevée, Tank',
    damageBrief: 'Haut DPS, Dégâts',
    supportBrief: 'Soin, Support',
    clickDesc: 'Cliquer: Voir relations',
    dragDesc: 'Glisser: Repositionner',
    zoomDesc: 'Zoom: Molette',
    hoverDesc: 'Survol: Surligner',
    panDesc: 'Pan: Glisser espace vide clic gauche ou bouton central n\'importe où',
    hardCounter: 'Contre Dur',
    strongCounter: 'Contre Fort',
    softCounter: 'Contre Doux',
    notCounteredByAny: 'Non contre par aucun héros',
    noCounters: 'Aucun héros contrés',
    counteredByTemplate: 'Modèle Faible',
    countersTemplate: 'Modèle Fort',
    counteredByHeader: ' est contré par :',
    countersHeader: ' contré :',
    copied: 'Copié',
    copy: 'Copier',
    copyTip: 'Double-cliquez ou bouton pour copier',
    counter: 'Contre',
    doubleClickToCopy: 'Double-cliquez pour copier',
    strength3: '★★★Dur',
    strength2: '★★Moyen',
    strength1: '★Doux',
    noCounterData: 'Pas assez de données',
    all: 'Tous',
    searchMapsPlaceholder: 'Rechercher cartes...',
    startingLineup: 'Composition Initiale',
    copyLineupTip: 'Copier composition',
    previewContent: 'Aperçu',
    recommendedLineup: 'Composition Recommandée',
    selectLanguage: 'Sélectionner Langue',
  },
  de: {
    title: 'Overwatch 2 Helden-Gegner-Beziehungen',
    subtitle: 'Wer Gegner Wen - Gegner-Graph',
    allHeroes: 'Alle Helden',
    tank: 'Tank',
    damage: 'Schaden',
    support: 'Support',
    roleFilter: 'Rollenfilter',
    instructions: 'Anleitung',
    stats: 'Statistiken',
    totalHeroes: 'Helden Gesamt',
    counterRelations: 'Gegner-Beziehungen',
    counteredBy: 'Gegner (Schwach)',
    counters: 'Gegner (Stark)',
    deselect: 'Abwählen',
    grayArrow: 'Grauer Pfeil',
    arrowDirection: 'Pfeilrichtung',
    dragNodes: 'Knoten ziehen zum Verschieben',
    scrollZoom: 'Scroll zum Zoomen',
    hoverView: 'Hover zum Anzeigen',
    clickHighlight: 'Klicken zum Hervorheben',
    counterRelation: 'Gegner-Beziehung',
    whoCountersWho: 'A → B bedeutet A gegen B',
    language: 'Sprache',
    github: 'GitHub',
    interactiveViz: 'Interaktive Visualisierung',
    loading: 'Laden...',
    selectHeroPrompt: 'Wähle einen Helden für Beziehungen',
    mapRecommendations: 'Kartenempfehlungen',
    heroCounterPanel: 'Gegner-Beziehungen',
    networkNodeIntro: 'Knoten-Einführung',
    mapType: 'Kartentyp',
    recommendedHeroes: 'Empfohlene Helden',
    control: 'Kontrolle',
    hybrid: 'Hybrid',
    escort: 'Begleitschutz',
    push: 'Schubsen',
    flashpoint: 'Blitzpunkt',
    lv3Desc: 'Harter Gegner (Nemesis)',
    lv2Desc: 'Starker Gegner (Vorteil)',
    lv1Desc: 'Leichter Gegner (Fähigkeit)',
    nodeSizeTip: 'Knotengröße: Stärker = Größer',
    nodeSizeLv3: 'LV.3 Max Größe',
    nodeSizeLv2: 'LV.2 Mittel Größe',
    nodeSizeLv1: 'LV.1 Klein Größe',
    tankBrief: 'Hohe Gesundheit, Tank',
    damageBrief: 'Hoher Schaden',
    supportBrief: 'Heilung, Support',
    clickDesc: 'Klicken: Beziehungen',
    dragDesc: 'Ziehen: Position',
    zoomDesc: 'Zoom: Mausrad',
    hoverDesc: 'Hover: Hervorheben',
    panDesc: 'Pan: Leeren Raum mit linker oder mittlerer Maustaste ziehen zum Verschieben',
    interactionGuide: 'Interaktionsanleitung',
    hardCounter: 'Hart',
    strongCounter: 'Stark',
    softCounter: 'Leicht',
    notCounteredByAny: 'Von keinem Helden schwach',
    noCounters: 'Keine schwachen Helden',
    counteredByTemplate: 'Schwach Vorlage',
    countersTemplate: 'Stark Vorlage',
    counteredByHeader: ' wird kontert von:',
    countersHeader: ' kontert:',
    copied: 'Kopiert',
    copy: 'Kopieren',
    copyTip: 'Doppelklick oder Button',
    counter: 'Gegner',
    doubleClickToCopy: 'Doppelklick zum Kopieren',
    strength3: '★★★Hart',
    strength2: '★★Stark',
    strength1: '★Leicht',
    noCounterData: 'Nicht genug Daten',
    all: 'Alle',
    searchMapsPlaceholder: 'Karten suchen...',
    startingLineup: 'Startaufstellung',
    copyLineupTip: 'Aufstellung kopieren',
    previewContent: 'Vorschau',
    recommendedLineup: 'Empfohlene Aufstellung',
    selectLanguage: 'Sprache Wählen',
  },
  pt: {
    title: 'Relações de Contador de Heróis Overwatch 2',
    subtitle: 'Quem Contre Quem - Gráfico de Contre',
    allHeroes: 'Todos os Heróis',
    tank: 'Tanque',
    damage: 'Dano',
    support: 'Suporte',
    roleFilter: 'Filtro de Função',
    instructions: 'Instruções',
    stats: 'Estatísticas',
    totalHeroes: 'Total de Heróis',
    counterRelations: 'Relações de Contre',
    counteredBy: 'Contra (Fraco Contra)',
    counters: 'Contra (Forte Contra)',
    deselect: 'Desselecionar',
    grayArrow: 'Seta Cinzenta',
    arrowDirection: 'Direção da Seta',
    dragNodes: 'Arrastar nós para reposicionar',
    scrollZoom: 'Scroll para zoom',
    hoverView: 'Hover para ver relações',
    clickHighlight: 'Clique para destacar',
    counterRelation: 'Relação de Contre',
    whoCountersWho: 'A → B significa A contra B',
    language: 'Idioma',
    github: 'GitHub',
    interactiveViz: 'Visualização Interativa',
    loading: 'Carregando...',
    selectHeroPrompt: 'Selecione um herói para ver relações',
    mapRecommendations: 'Recomendações de Mapa',
    heroCounterPanel: 'Relações de Contre',
    networkNodeIntro: 'Intro de Nós',
    mapType: 'Tipo de Mapa',
    recommendedHeroes: 'Heróis Recomendados',
    control: 'Controle',
    hybrid: 'Híbrido',
    escort: 'Escolta',
    push: 'Empurrão',
    flashpoint: 'Ponto Flash',
    lv3Desc: 'Contra Dura (Nêmesis)',
    lv2Desc: 'Contra Forte (Vantagem)',
    lv1Desc: 'Contra Suave (Habilidade)',
    nodeSizeTip: 'Tamanho nó: Mais forte = Maior',
    nodeSizeLv3: 'LV.3 Tamanho máximo',
    nodeSizeLv2: 'LV.2 Tamanho médio',
    nodeSizeLv1: 'LV.1 Tamanho pequeno',
    tankBrief: 'Alta Vida, Tanque',
    damageBrief: 'Alto DPS, Dano',
    supportBrief: 'Cura, Suporte',
    clickDesc: 'Clique: Ver relações',
    dragDesc: 'Arrastar: Reposicionar',
    zoomDesc: 'Zoom: Roda do mouse',
    hoverDesc: 'Hover: Destacar',
    panDesc: 'Pan: Arrastar a tela com o botão esquerdo ou central para mover',
    interactionGuide: 'Guia de Interação',
    hardCounter: 'Contra Dura',
    strongCounter: 'Contra Forte',
    softCounter: 'Contra Suave',
    notCounteredByAny: 'Não contra por nenhum herói',
    noCounters: 'Nenhum herói contrado',
    counteredByTemplate: 'Modelo Fraco',
    countersTemplate: 'Modelo Forte',
    counteredByHeader: ' é contrariado por:',
    countersHeader: ' contrária:',
    copied: 'Copiado',
    copy: 'Copiar',
    copyTip: 'Duplo clique ou botão',
    counter: 'Contra',
    doubleClickToCopy: 'Duplo clique para copiar',
    strength3: '★★★Dura',
    strength2: '★★Média',
    strength1: '★Suave',
    noCounterData: 'Dados insuficientes',
    all: 'Todos',
    searchMapsPlaceholder: 'Buscar mapas...',
    startingLineup: 'Formação Inicial',
    copyLineupTip: 'Copiar formação',
    previewContent: 'Pré-visualização',
    recommendedLineup: 'Formação Recomendada',
    selectLanguage: 'Selecionar Idioma',
  },
  ru: {
    title: 'Отношения Контроу Героев Overwatch 2',
    subtitle: 'Кто Кого Контрит - График Контров',
    allHeroes: 'Все Герои',
    tank: 'Танк',
    damage: 'ДПС',
    support: 'Поддержка',
    roleFilter: 'Фильтр Ролей',
    instructions: 'Инструкции',
    stats: 'Статистика',
    totalHeroes: 'Всего Героев',
    counterRelations: 'Отношения Контров',
    counteredBy: 'Контрится (Слаб)',
    counters: 'Контрит (Сильн)',
    deselect: 'Отменить',
    grayArrow: 'Серый Стрелка',
    arrowDirection: 'Направление Стрелки',
    dragNodes: 'Тянуть узлы для перемещения',
    scrollZoom: 'Скролл для зума',
    hoverView: 'Ховер для просмотра',
    clickHighlight: 'Клик для подсветки',
    counterRelation: 'Отношение Контра',
    whoCountersWho: 'A → B значит A контрит B',
    language: 'Язык',
    github: 'GitHub',
    interactiveViz: 'Интерактивная Визуализация',
    loading: 'Загрузка...',
    selectHeroPrompt: 'Выберите героя для просмотра',
    mapRecommendations: 'Рекомендации Карт',
    heroCounterPanel: 'Отношения Контров',
    networkNodeIntro: 'Описание Узлов',
    mapType: 'Тип Карты',
    recommendedHeroes: 'Рекомендуемые Герои',
    control: 'Контроль',
    hybrid: 'Гибрид',
    escort: 'Сопровождение',
    push: 'Пуш',
    flashpoint: 'Точка Вспышки',
    lv3Desc: 'Хард Контр (Незис)',
    lv2Desc: 'Сильный Контр (Преимущество)',
    lv1Desc: 'Мягкий Контр (Скилл)',
    nodeSizeTip: 'Размер узла: Сильнее = Больше',
    nodeSizeLv3: 'LV.3 Макс размер',
    nodeSizeLv2: 'LV.2 Сред размер',
    nodeSizeLv1: 'LV.1 Мал размер',
    tankBrief: 'ХП, Танк',
    damageBrief: 'Высокий ДПС',
    supportBrief: 'Лечение, Поддержка',
    clickDesc: 'Клик: Смотреть',
    dragDesc: 'Тянуть: Перемещать',
    zoomDesc: 'Зум: Колесо мыши',
    hoverDesc: 'Ховер: Подсветка',
    panDesc: 'Pan: Тянуть пустое пространство левой кнопкой или средней кнопкой для перемещения',
    hardCounter: 'Хард',
    strongCounter: 'Сильный',
    softCounter: 'Мягкий',
    notCounteredByAny: 'Не контрится никем',
    noCounters: 'Нет кого контрить',
    counteredByTemplate: 'Шаблон Слаб',
    countersTemplate: 'Шаблон Сильн',
    counteredByHeader: ' контр-ся:',
    countersHeader: ' контр-т:',
    copied: 'Скопировано',
    copy: 'Копировать',
    copyTip: 'Двойной клик или кнопка',
    counter: 'Контр',
    doubleClickToCopy: 'Двойной клик',
    strength3: '★★★Хард',
    strength2: '★★Сильн',
    strength1: '★Мягк',
    noCounterData: 'Недостаточно данных',
    all: 'Все',
    searchMapsPlaceholder: 'Поиск карт...',
    startingLineup: 'Стартовый Состав',
    copyLineupTip: 'Копировать состав',
    previewContent: 'Превью',
    recommendedLineup: 'Рекомендуемый Состав',
    selectLanguage: 'Выбрать Язык',
  },
  it: {
    title: 'Relazioni Contro Eroi Overwatch 2',
    subtitle: 'Chi Contro Chi - Grafico Contro',
    allHeroes: 'Tutti gli Eroi',
    tank: 'Tank',
    damage: 'Danno',
    support: 'Supporto',
    roleFilter: 'Filtro Ruolo',
    instructions: 'Istruzioni',
    stats: 'Statistiche',
    totalHeroes: 'Totale Eroi',
    counterRelations: 'Relazioni Contro',
    counteredBy: 'Contro (Debole Contro)',
    counters: 'Contro (Forte Contro)',
    deselect: 'Deseleziona',
    grayArrow: 'Freccia Grigia',
    arrowDirection: 'Direzione Freccia',
    dragNodes: 'Trascina nodi per riposizionare',
    scrollZoom: 'Scroll per zoom',
    hoverView: 'Hover per vedere relazioni',
    clickHighlight: 'Click per evidenziare',
    counterRelation: 'Relazione Contro',
    whoCountersWho: 'A → B significa A contro B',
    language: 'Lingua',
    github: 'GitHub',
    interactiveViz: 'Visualizzazione Interattiva',
    loading: 'Caricamento...',
    selectHeroPrompt: 'Seleziona un eroe per vedere relazioni',
    mapRecommendations: 'Raccomandazioni Mappa',
    heroCounterPanel: 'Relazioni Contro',
    networkNodeIntro: 'Intro Nodi',
    mapType: 'Tipo Mappa',
    recommendedHeroes: 'Eroi Raccomandati',
    control: 'Controllo',
    hybrid: 'Ibrido',
    escort: 'Scorta',
    push: 'Spingere',
    flashpoint: 'Punto Flash',
    lv3Desc: 'Contro Duro (Nemico)',
    lv2Desc: 'Contro Forte (Vantaggio)',
    lv1Desc: 'Contro Leggero (Skill)',
    nodeSizeTip: 'Dimensione nodo: Più forte = Più grande',
    nodeSizeLv3: 'LV.3 Dimensione massima',
    nodeSizeLv2: 'LV.2 Dimensione media',
    nodeSizeLv1: 'LV.1 Dimensione piccola',
    tankBrief: 'Alta Vita, Tank',
    damageBrief: 'Alto DPS, Danno',
    supportBrief: 'Cura, Supporto',
    clickDesc: 'Click: Vedere relazioni',
    dragDesc: 'Trascinare: Riposizionare',
    zoomDesc: 'Zoom: Rotella mouse',
    hoverDesc: 'Hover: Evidenziare',
    panDesc: 'Pan: Trascinare la tela con il pulsante sinistro o centrale per spostare',
    interactionGuide: 'Guida all\'Interazione',
    hardCounter: 'Contro Duro',
    strongCounter: 'Contro Forte',
    softCounter: 'Contro Leggero',
    notCounteredByAny: 'Non contro da nessun eroe',
    noCounters: 'Nessun eroe contro',
    counteredByTemplate: 'Modello Debole',
    countersTemplate: 'Modello Forte',
    counteredByHeader: ' è contraddetto da:',
    countersHeader: ' contraddice:',
    copied: 'Copiato',
    copy: 'Copiare',
    copyTip: 'Doppio click o pulsante',
    counter: 'Contro',
    doubleClickToCopy: 'Doppio click per copiare',
    strength3: '★★★Duro',
    strength2: '★★Forte',
    strength1: '★Leggero',
    noCounterData: 'Dati insufficienti',
    all: 'Tutti',
    searchMapsPlaceholder: 'Cerca mappe...',
    startingLineup: 'Formazione Iniziale',
    copyLineupTip: 'Copiare formazione',
    previewContent: 'Anteprima',
    recommendedLineup: 'Formazione Raccomandata',
    selectLanguage: 'Selezionare Lingua',
  },
};


interface I18nContextType {
  language: Language;
  setLanguage: (lang: Language) => void;
  t: (key: string) => string;
}

const I18nContext = createContext<I18nContextType | null>(null);

export function I18nProvider({ children }: { children: ReactNode }) {
  // 首先检查 localStorage 是否有用户保存的语言设置
  const savedLanguage = typeof window !== 'undefined' ? localStorage.getItem('language') as Language | null : null;
  
  const [language, setLanguageState] = useState<Language>(savedLanguage || 'en');

  const setLanguage = useCallback((lang: Language) => {
    setLanguageState(lang);
    localStorage.setItem('language', lang);
  }, []);

  useEffect(() => {
    // 如果用户没有保存语言设置，则自动检测
    if (!savedLanguage) {
      const detectLanguage = async () => {
        try {
          const response = await fetch('https://ipapi.co/json/');
          const data = await response.json();
          
          const isChina = 
            data.country_code === 'CN' || 
            data.country_name === 'China' ||
            data.region === 'China';
          
          const detectedLanguage: Language = isChina ? 'zh' : 'en';
          setLanguageState(detectedLanguage);
          localStorage.setItem('language', detectedLanguage);
        } catch (error) {
          setLanguageState('en');
          localStorage.setItem('language', 'en');
        }
      };
      
      detectLanguage();
    }
  }, [savedLanguage]);

  const t = useCallback(
    (key: string): string => {
      return translations[language][key] || key;
    },
    [language]
  );

  return React.createElement(
    I18nContext.Provider,
    { value: { language, setLanguage, t } },
    children
  );
}

export function useI18n(): I18nContextType {
  const context = useContext(I18nContext);
  if (!context) {
    throw new Error('useI18n must be used within an I18nProvider');
  }
  return context;
}
